/*! vim_man_bot 2014-08-23 */
function getHTML(a){var b="";return $.ajax({dataType:"html",url:a,async:!1,success:function(a){b=a}}),b}function getPresetComponent(){return{created:function(){this.$dispatch("content-created",this)},ready:function(){this.$dispatch("content-ready",this)},attached:function(){this.$dispatch("content-attached",this)},detached:function(){this.$dispatch("content-detached",this)},beforeDestroy:function(){this.$dispatch("content-beforeDestroy",this)},afterDestroy:function(){this.$dispatch("content-afterDestroy",this)}}}function buildQueryString(a,b){var c=[];for(var d in a){var e=b?b+"["+d+"]":d,f=a[d];c.push("object"==typeof f?buildQueryString(f,e):encodeURIComponent(e)+"="+encodeURIComponent(f))}return c.join("&")}function getPages(a,b,c){for(var d=[],e=b/c,f=a;e>=f;f++)d.push(f);return d}function getPresetListComponent(a){return{template:getHTML("assets/js/app/components/"+a+"/template.html"),created:function(){console.log(a,"component.created"),this.fetch()},beforeDestroy:function(){console.log(a,"component.beforeDestroy"),this.$dispatch("content-beforeDestroy",this),this.notFound(),this.loading(!0)},methods:{fetch:function(){this.loading(!0);var b=this,c="assets/js/app/components/"+a+"/dummy.json",d=buildQueryString(this.$parent.conditions),e=this.$parent.conditions.page;console.log("queryString",d),window.setTimeout(function(){$.ajax({url:c+"?"+d,dataType:"json"}).done(function(a){console.log("success",a),b.found(a,e)}).fail(function(a){console.log("failure",a),b.notFound()}),window.location.href=window.location.href+"?"+d},800)},loading:function(a){this.$parent.isLoading=a},found:function(a,b){console.log("found",a,b),this.$parent.result.list=a.result,this.$parent.result.currentPage=b,this.$parent.result.pages=getPages(b,a.total_count,10),this.$parent.result.totalCount=a.total_count,this.$parent.result.totalPage=Math.ceil(a.total_count/10),this.loading(!1)},notFound:function(){this.$parent.result.list=[],this.$parent.result.currentPage=1,this.$parent.result.pages=[],this.$parent.result.totalCount=0,this.$parent.result.currentPage=1,this.loading(!1)},remove:function(a){console.log("remove",a),confirm("本当に削除しますか？")},page:function(a){console.log("page",a),this.$parent.conditions.page=a,this.fetch()},prevPage:function(a){if(!$(a.target).closest("li").hasClass("disabled")){console.log("prevPage");var b=this.$parent.result.currentPage;b--,this.$parent.conditions.page=b,this.fetch()}},nextPage:function(a){if(!$(a.target).closest("li").hasClass("disabled")){console.log("nextPage");var b=this.$parent.result.currentPage;b++,this.$parent.conditions.page=b,this.fetch()}}}}}function mergeComponent(a){return Vue.extend(jQuery.extend(getPresetComponent(),a))}Vue.component("questions",getPresetListComponent("questions")),Vue.component("questions-create",mergeComponent({template:getHTML("assets/js/app/components/questions-create/template.html")})),Vue.component("questions-update",mergeComponent({template:getHTML("assets/js/app/components/questions-update/template.html")})),Vue.component("operators",getPresetListComponent("operators")),Vue.component("operators-create",mergeComponent({template:getHTML("assets/js/app/components/operators-create/template.html")})),Vue.component("operators-update",mergeComponent({template:getHTML("assets/js/app/components/operators-update/template.html")})),Vue.component("informations",getPresetListComponent("informations")),Vue.component("informations-create",mergeComponent({template:getHTML("assets/js/app/components/informations-create/template.html")})),Vue.component("informations-update",mergeComponent({template:getHTML("assets/js/app/components/informations-update/template.html")})),Vue.component("responses",getPresetListComponent("responses")),Vue.component("responses-create",mergeComponent({template:getHTML("assets/js/app/components/responses-create/template.html")})),Vue.component("responses-update",mergeComponent({template:getHTML("assets/js/app/components/responses-update/template.html")})),Vue.component("tweets",getPresetListComponent("tweets")),Vue.component("pagination",Vue.extend({template:getHTML("assets/js/app/components/pagination/template.html")})),function(a){"use strict";a.app=new Vue({el:"#app",data:{currentView:"questions",isLoading:!0,conditions:{page:1},result:{totalCount:0,totalPage:0,currentPage:1,list:[],pages:[]}},filters:{formatDate:function(a){return a.substr(0,a.length-3)}},created:function(){var a=this;this.$on("content-created",function(){console.log(a.$data.currentView,"created")})},ready:function(){var a=this;this.$on("content-ready",function(){console.log(a.$data.currentView,"ready")})},attached:function(){var a=this;this.$on("content-attached",function(){console.log(a.$data.currentView,"attached")})},detached:function(){var a=this;this.$on("content-detached",function(){console.log(a.$data.currentView,"detached")})},beforeDestroy:function(){var a=this;this.$on("content-beforeDestroy",function(){console.log(a.$data.currentView,"beforeDestroy")})},afterDestroy:function(){var a=this;this.$on("content-afterDestroy",function(){console.log(a.$data.currentView,"afterDestroy")})},methods:{}})}(window),function(){"use strict";var a={};a["/"]=function(){app.currentView="questions"},a["/questions"]=function(){app.currentView="questions"},a["/questions/create"]=function(){app.currentView="questions-create"},a["/questions/:id/update"]=function(){app.currentView="questions-update"},a["/questions/:id/delete"]=function(){},a["/responses"]=function(){app.currentView="responses"},a["/responses/create"]=function(){app.currentView="responses-create"},a["/responses/:id/update"]=function(){app.currentView="responses-update"},a["/responses/:id/delete"]=function(){},a["/informations"]=function(){app.currentView="informations"},a["/informations/create"]=function(){app.currentView="informations-create"},a["/informations/:id/update"]=function(){app.currentView="informations-update"},a["/tweets"]=function(){app.currentView="tweets"},a["/operators"]=function(){app.currentView="operators"},a["/operators/create"]=function(){app.currentView="operators-create"},a["/operators/:id/update"]=function(){app.currentView="operators-update"};var b=new Router(a);b.init()}(window);