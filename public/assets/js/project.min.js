function getHTML(t){var e="";return $.ajax({dataType:"html",url:t,async:!1,success:function(t){e=t}}),e}function getPresetComponent(){return{created:function(){this.$dispatch("content-created",this)},ready:function(){this.$dispatch("content-ready",this)},attached:function(){this.$dispatch("content-attached",this)},detached:function(){this.$dispatch("content-detached",this)},beforeDestroy:function(){this.$dispatch("content-beforeDestroy",this)},afterDestroy:function(){this.$dispatch("content-afterDestroy",this)}}}function buildQueryString(t,e){var n=[];for(var o in t){var s=e?e+"["+o+"]":o,a=t[o];n.push("object"==typeof a?buildQueryString(a,s):encodeURIComponent(s)+"="+encodeURIComponent(a))}return n.join("&")}function getPages(t,e,n){for(var o=[],s=e/n,a=t;s>=a;a++)o.push(a);return o}function getPresetListComponent(t){return{template:getHTML("assets/js/app/components/"+t+"/template.html"),created:function(){console.log(t,"component.created"),this.fetch()},beforeDestroy:function(){console.log(t,"component.beforeDestroy"),this.$dispatch("content-beforeDestroy",this),this.notFound(),this.loading(!0)},methods:{fetch:function(){this.loading(!0);var e=this,n="assets/js/app/components/"+t+"/dummy.json",o=buildQueryString(this.$parent.conditions),s=this.$parent.conditions.page;console.log("queryString",o),window.setTimeout(function(){$.ajax({url:n+"?"+o,dataType:"json"}).done(function(t){console.log("success",t),e.found(t,s)}).fail(function(t){console.log("failure",t),e.notFound()});var t=window.location.href.replace(/\?.*/,"");window.location.href=t+"?"+o},800)},loading:function(t){this.$parent.isLoading=t},found:function(t,e){console.log("found",t,e),this.$parent.result.list=t.result,this.$parent.result.currentPage=e,this.$parent.result.pages=getPages(e,t.total_count,10),this.$parent.result.totalCount=t.total_count,this.$parent.result.totalPage=Math.ceil(t.total_count/10),this.loading(!1)},notFound:function(){this.$parent.result.list=[],this.$parent.result.currentPage=1,this.$parent.result.pages=[],this.$parent.result.totalCount=0,this.$parent.result.currentPage=1,this.loading(!1)},remove:function(t){console.log("remove",t),confirm("本当に削除しますか？")},page:function(t){console.log("page",t),this.$parent.conditions.page=t,this.fetch()},prevPage:function(t){if(!$(t.target).closest("li").hasClass("disabled")){console.log("prevPage");var e=this.$parent.result.currentPage;e--,this.$parent.conditions.page=e,this.fetch()}},nextPage:function(t){if(!$(t.target).closest("li").hasClass("disabled")){console.log("nextPage");var e=this.$parent.result.currentPage;e++,this.$parent.conditions.page=e,this.fetch()}}}}}function mergeComponent(t){return Vue.extend(jQuery.extend(getPresetComponent(),t))}Vue.component("questions",getPresetListComponent("questions")),Vue.component("questions-create",mergeComponent({template:getHTML("assets/js/app/components/questions-create/template.html")})),Vue.component("questions-update",mergeComponent({template:getHTML("assets/js/app/components/questions-update/template.html")})),Vue.component("operators",getPresetListComponent("operators")),Vue.component("operators-create",mergeComponent({template:getHTML("assets/js/app/components/operators-create/template.html")})),Vue.component("operators-update",mergeComponent({template:getHTML("assets/js/app/components/operators-update/template.html")})),Vue.component("informations",getPresetListComponent("informations")),Vue.component("informations-create",mergeComponent({template:getHTML("assets/js/app/components/informations-create/template.html")})),Vue.component("informations-update",mergeComponent({template:getHTML("assets/js/app/components/informations-update/template.html")})),Vue.component("responses",getPresetListComponent("responses")),Vue.component("responses-create",mergeComponent({template:getHTML("assets/js/app/components/responses-create/template.html")})),Vue.component("responses-update",mergeComponent({template:getHTML("assets/js/app/components/responses-update/template.html")})),Vue.component("tweets",getPresetListComponent("tweets")),Vue.component("pagination",Vue.extend({template:getHTML("assets/js/app/components/pagination/template.html")})),function(t){"use strict";t.app=new Vue({el:"#app",data:{currentView:"questions",isLoading:!0,conditions:{page:1},result:{totalCount:0,totalPage:0,currentPage:1,list:[],pages:[]}},filters:{formatDate:function(t){return t.substr(0,t.length-3)}},created:function(){var t=this;this.$on("content-created",function(){console.log(t.$data.currentView,"created")})},ready:function(){var t=this;this.$on("content-ready",function(){console.log(t.$data.currentView,"ready")})},attached:function(){var t=this;this.$on("content-attached",function(){console.log(t.$data.currentView,"attached")})},detached:function(){var t=this;this.$on("content-detached",function(){console.log(t.$data.currentView,"detached")})},beforeDestroy:function(){var t=this;this.$on("content-beforeDestroy",function(){console.log(t.$data.currentView,"beforeDestroy")})},afterDestroy:function(){var t=this;this.$on("content-afterDestroy",function(){console.log(t.$data.currentView,"afterDestroy")})},methods:{}})}(window),function(){"use strict";var t={};t["/(questions)?"]=function(){app.currentView="questions"},t["/questions/create"]=function(){app.currentView="questions-create"},t["/questions/:id/update"]=function(){app.currentView="questions-update"},t["/questions/:id/delete"]=function(){},t["/responses"]=function(){app.currentView="responses"},t["/responses/create"]=function(){app.currentView="responses-create"},t["/responses/:id/update"]=function(){app.currentView="responses-update"},t["/responses/:id/delete"]=function(){},t["/informations"]=function(){app.currentView="informations"},t["/informations/create"]=function(){app.currentView="informations-create"},t["/informations/:id/update"]=function(){app.currentView="informations-update"},t["/tweets"]=function(){app.currentView="tweets"},t["/operators"]=function(){app.currentView="operators"},t["/operators/create"]=function(){app.currentView="operators-create"},t["/operators/:id/update"]=function(){app.currentView="operators-update"};var e=new Router(t);e.init()}(window);