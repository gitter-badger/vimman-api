function getPresetComponent(){return{created:function(){this.$dispatch("content-created",this)},ready:function(){this.$dispatch("content-ready",this)},attached:function(){this.$dispatch("content-attached",this)},detached:function(){this.$dispatch("content-detached",this)},beforeDestroy:function(){this.$dispatch("content-beforeDestroy",this)},afterDestroy:function(){this.$dispatch("content-afterDestroy",this)}}}function getPresetListComponent(t){return{template:Utils.getHTML("assets/js/app/components/"+t+"/template.html"),created:function(){console.log(t,"component.created"),this.resetCondition();var e=window.location.href.match(/\?(.*)/);if(e&&e[1]){var n=Utils.parseQueryString(e[1]);this.assignSearchForm(n)}this.search()||this.fetch(this.$parent.conditions)},beforeDestroy:function(){console.log(t,"component.beforeDestroy"),this.$dispatch("content-beforeDestroy",this),this.notFound(),this.loading(!0)},methods:{fetch:function(e){console.log("fetch",e),this.loading(!0);var n=this,o="http://localhost:5000/"+t,s=Utils.buildQueryString(e),r=e.page;window.setTimeout(function(){$.ajax({url:o+"?"+s,dataType:"json"}).done(function(t){console.log("success",t),n.found(t,r)}).fail(function(t){console.log("failure",t),n.notFound()});var t=window.location.href.replace(/\?.*/,"");console.log(t),console.log(e),t+=e?"?"+s:"",console.log("pushStateUrl",window.location.href," => ",t),window.location.href=t},800)},loading:function(t){this.$parent.isLoading=t},found:function(t,e){console.log("found",t,"page",e),this.$parent.result.list=t.result,this.$parent.result.currentPage=e,this.$parent.result.pages=Utils.calcPagination(e,t.total_count,10,4),this.$parent.result.totalCount=t.total_count,this.$parent.result.totalPage=Math.ceil(t.total_count/10),this.loading(!1)},notFound:function(){console.log("notFound"),this.$parent.result.list=[],this.$parent.result.currentPage=1,this.$parent.result.pages=[],this.$parent.result.totalCount=0,this.$parent.result.totalPage=0,this.$parent.result.currentPage=1,this.loading(!1)},resetCondition:function(){this.$parent.conditions={},this.$parent.conditions.page=1},remove:function(t){console.log("remove",t),confirm("本当に削除しますか？")},page:function(t){console.log("page",t),this.$parent.conditions.page=t,this.fetch(this.$parent.conditions)},prevPage:function(t){if(!$(t.target).closest("li").hasClass("disabled")){var e=this.$parent.result.currentPage-1;this.page(e)}},nextPage:function(t){if(!$(t.target).closest("li").hasClass("disabled")){var e=this.$parent.result.currentPage+1;this.page(e)}},search:function(){var t=$(this.$el).find(".search-form");if(1!==t.size())return!1;var e={},n=t.serializeArray();for(var o in n){var s=n[o],r=s.name.match(/search\[(.+)\]/);r&&r[1]&&(e[r[1]]=s.value)}0<e.length&&(this.$parent.conditions.search=e),this.fetch(this.$parent.conditions)},assignSearchForm:function(t){for(var e in t){var n=t[e],o=decodeURIComponent(e);$('[name="'+o+'"]').val(n)}}}}}function mergeComponent(t){return Vue.extend(jQuery.extend(getPresetComponent(),t))}!function(t){t.Utils={getHTML:function(t){var e="";return $.ajax({dataType:"html",url:t,async:!1,success:function(t){e=t}}),e},buildQueryString:function(t,e){var n=[];for(var o in t){var s=e?e+"["+o+"]":o,r=t[o];s&&r&&n.push("object"==typeof r?Utils.buildQueryString(r,s):encodeURIComponent(s)+"="+encodeURIComponent(r))}return n.join("&")},parseQueryString:function(t){var e={},n=t.split("&");for(var o in n){var s=n[o].split("=");console.log(o,s),s[0]&&s[1]&&(e[s[0]]=s[1])}return e},_parseQueryString:function(t){var e={};for(var n in t){var o=t[n].split("=");console.log(n,o),o[0].match(/(.+)\[(.+)\]/)?console.log("_parseQueryString",RegExp.$1,RegExp.$2):e[o[0]]=o[1]}return e},getPages:function(t,e,n){for(var o=[],s=e/n,r=t;s>=r;r++)o.push(r);return o},calcPagination:function(t,e,n,o){var s=Math.ceil(e/n),r=0;o>=t&&(r=o-(t+1));for(var a=t+o+r,i=[],c=t-o;a>=c&&s>=c;c++)1>c||i.push(c);return i}}}(window),Vue.component("questions",getPresetListComponent("questions")),Vue.component("questions-create",mergeComponent({template:Utils.getHTML("assets/js/app/components/questions-create/template.html")})),Vue.component("questions-update",mergeComponent({template:Utils.getHTML("assets/js/app/components/questions-update/template.html")})),Vue.component("operators",getPresetListComponent("operators")),Vue.component("operators-create",mergeComponent({template:Utils.getHTML("assets/js/app/components/operators-create/template.html")})),Vue.component("operators-update",mergeComponent({template:Utils.getHTML("assets/js/app/components/operators-update/template.html")})),Vue.component("informations",getPresetListComponent("informations")),Vue.component("informations-create",mergeComponent({template:Utils.getHTML("assets/js/app/components/informations-create/template.html")})),Vue.component("informations-update",mergeComponent({template:Utils.getHTML("assets/js/app/components/informations-update/template.html")})),Vue.component("responses",getPresetListComponent("responses")),Vue.component("responses-create",mergeComponent({template:Utils.getHTML("assets/js/app/components/responses-create/template.html")})),Vue.component("responses-update",mergeComponent({template:Utils.getHTML("assets/js/app/components/responses-update/template.html")})),Vue.component("tweets",getPresetListComponent("tweets")),Vue.component("pagination",Vue.extend({template:Utils.getHTML("assets/js/app/components/pagination/template.html")})),function(t){"use strict";t.app=new Vue({el:"#app",data:{currentView:"questions",isLoading:!0,conditions:{page:1},result:{totalCount:0,totalPage:0,currentPage:1,list:[],pages:[]}},filters:{formatDate:function(t){return t.substr(0,t.length-3)}},created:function(){var t=this;this.$on("content-created",function(){console.log(t.$data.currentView,"created")})},ready:function(){var t=this;this.$on("content-ready",function(){console.log(t.$data.currentView,"ready")})},attached:function(){var t=this;this.$on("content-attached",function(){console.log(t.$data.currentView,"attached")})},detached:function(){var t=this;this.$on("content-detached",function(){console.log(t.$data.currentView,"detached")})},beforeDestroy:function(){var t=this;this.$on("content-beforeDestroy",function(){console.log(t.$data.currentView,"beforeDestroy")})},afterDestroy:function(){var t=this;this.$on("content-afterDestroy",function(){console.log(t.$data.currentView,"afterDestroy")})},methods:{}})}(window),function(){"use strict";var t={};t["/(questions)?(\\?.*)?"]=function(){app.currentView="questions"},t["/questions/create"]=function(){app.currentView="questions-create"},t["/questions/:id/update"]=function(){app.currentView="questions-update"},t["/questions/:id/delete"]=function(){},t["/responses(\\?.*)?"]=function(){app.currentView="responses"},t["/responses/create"]=function(){app.currentView="responses-create"},t["/responses/:id/update"]=function(){app.currentView="responses-update"},t["/responses/:id/delete"]=function(){},t["/informations(\\?.*)?"]=function(){app.currentView="informations"},t["/informations/create"]=function(){app.currentView="informations-create"},t["/informations/:id/update"]=function(){app.currentView="informations-update"},t["/tweets(\\?.*)?"]=function(){app.currentView="tweets"},t["/operators(\\?.*)?"]=function(){app.currentView="operators"},t["/operators/create"]=function(){app.currentView="operators-create"},t["/operators/:id/update"]=function(){app.currentView="operators-update"};var e=new Router(t);e.init()}(window);